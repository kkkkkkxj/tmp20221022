# 3.1 数据库基础—范式

##  1.数据库

### (1)定义

数据库是“按照数据结构来==组织、存储和管理数据==的仓库”。是一个**长期存储在计算机内的、有组织的、可共享的、统一管理**的大量数据的**集合**。

### (2)数据库的由来

数据库的由来：规范化的**本地存储、加密、共享**。

### (3)分类

1. **关系型数据库**：其实就是**二维表**, 典型代表mysql, oracle, SQL Server。是一种m:n、**多对多**的关系，可以有很多个人都是19岁，可以有很多个人都叫张三，每个张三年纪都不一样

   | age  | name |
   | ---- | ---- |
   | 18   | 张三 |
   | 19   | 李四 |

   

2. **非关系型数据库**：也叫**NoSql** , 是一维映射 key-value 典型代表 redis , MongoDB

   | key      | value                 |
   | -------- | --------------------- |
   | “id = 0” | 张三                  |
   | “id = 1” | name = 张三  age = 12 |
   | “id = 2” | name = 李四 age = 15  |

### (4)数据库的名词

**属性** :别名也叫特征 --> 表中的一列-->字段

**元组**: 表的一行就叫一个元组

**码(关键字)**: 表中唯一确定一个元组的属性. 码不止一个, 叫这些为==候选码==

**主码**:从候选码挑选出来一个主要确定这一行的属性

**主属性**:只要在任何一个候选码中出现过, 这个属性就叫主属性.

**非主属性**: 没有在任何一个候选码中出现过





## 2.数据库范式

### (1)定义

要想设计一个好的关系，必须使关系满足一定的约束条件，此约束已经形成了规范 , 按照这种规范可以使设计简洁的、结构明晰, 不会因为插入删除, 更新数据导致异常。

强调一下，后面讲到的都是==关系型数据库==的内容。

- **范式**有很多，不用全部都掌握，基本上掌握下列这几种范式就足够用了。

### (2)分类

**注意**：范式关系是**层层递进**的，需要**先遵守第一范式，再遵守第二范式，再遵守第三范式**。也就是说不符合第三范式的表一定是符合第二范式规则的表。第三范式主要看非主键列相互之间是否有决定关系。如：**若不满足第二范式，则第三范式一定不满足**

#### 1>第一范式

**属性不可分**。比如下面这个表，这个是一个没有问题代表，每个属性都只有一个：

| **name** | tel          | sex  |
| -------- | ------------ | ---- |
| 小明     | 12345678999  | 男   |
| 小红     | 111111111111 | 女   |

**反例**：下例就是不符合第一范式的表

![image-20230513220010194](C:\Users\kxj\AppData\Roaming\Typora\typora-user-images\image-20230513220010194.png)

#### 2>第二范式

不存在组合关键字中的某些字段决定非关键字段 (==即组合关键字不可拆==)。这句话不是很好理解。

比如说有一个公司有董事长和总经理，有些事需要董事长和总经理共同才能决定，有些事需要董事长自己决定，有些事需要总经理决定，这种场景就不符合第二范式。一起看一下下面这些场景是否符合第二范式：当非主键列全部依赖与主键时，是符合第二范式的；当非主键列依赖于部分主键时，是不符合第二范式的；当非主键列部分依赖于全部主键时，也是不符合第二范式的；当非主键列部分依赖于部分主键时，也是不符合第二范式的。

![image-20230513220716528](C:\Users\kxj\AppData\Roaming\Typora\typora-user-images\image-20230513220716528.png)



下例是**不满足第二范式**的反例：

选课课表 SelectCourse ( 学号, 姓名, 年龄, 课程名称, 成绩 , 学分)。其中**( 学号, 课程名称 ) 决定 ( 姓名 , 年龄 , 成绩 , 学分)**，但是**(学号)可以单独决定 (姓名 , 年龄)**，**(课程名称)可以单独决定(学分)**。这就**不符合第二范式**了。							不符合第二范式会有什么问题呢？假设按照这个表保存数据，一般查找是没什么问题的。首先出现的问题就是**数据冗余**，里面出现了两个数学和两个语文。现在需要更新数学的学分到5分，需要更新的数据行数就很多，有多少个同学选修数学就需要更新多少行，这就是设计表的时候设计的不好导致的问题。而且这个表这么设计，一个同学就没办法选修多门课程，因为课程不能单独存在，必须有学号，但是学号是不能重复的，就导致没有办法插入这种数据了。同理，删除也会有问题。

![image-20230513220909085](C:\Users\kxj\AppData\Roaming\Typora\typora-user-images\image-20230513220909085.png)

通过上面的分析可以发现，**不满足第二范式**就会出现这几个问题：

1. **数据冗余** 
2. **更新异常**
3. **插入异常**

解决方法是==拆表==，修改方案：学生表：学号，姓名，年龄；课程表：课程名称，学分；选课表：学号，课程名称，成绩

其中，课程表里面还可以增加一列课程id，然后选课表里面把课程名称换成课程id，这样如果有课程改了名字，比如说从数学改成高数，那么选课表里面也是不需要修改的。这样的设计更合理、更好一些。



#### 3>第三范式

不存在依赖传递。也就是说不能存在**属性1决定属性2**，**属性2再决定属性3**的情况。也就是不能出现**关键字段--> 非关键字段x -->非关键字段y**的情况

**下面来看一个反例**：

学生的关系表：（学号，姓名，年龄，所在学院，学院地点，学院电话）这个表看起来好像是**（学号）-->（姓名，年龄，所在学院，学院地点，学院电话）**，实际上这里面还存在着另一个关系：**（学号）--> 所在学院--> 学院地点，学院电话**。还是先按照这个表填入数据，看一下会有什么问题。																											首先，会有冗余信息，不同的同学在同一个学院，学院地址和电话都相同。插入的时候也会有问题，如果新成立一个学院但是还没有学生，没有办法单独插入一个学院。更新数据的时候也会比较麻烦，如果学院电话变了需要更新，需要更新很多行。 

![image-20230513221326247](C:\Users\kxj\AppData\Roaming\Typora\typora-user-images\image-20230513221326247.png)

**解决方式**：**拆表**；就是把学生和学院分别放在两个表中，学生表中包含学院的id。

#### 4>BCNF(鲍依斯-科得范式)

==不存在关键字段决定关键字段。==

举个例子：仓库管理系统（仓库ID，存储物品ID，管理员ID，数量）。这张表中，一个仓库可以有多个管理员，白天一个管理员，晚上一个管理员。一个管理员也可以管理多个仓库。那么，仓库ID可以决定管理员ID，管理员ID也可以决定仓库ID，这就是关键字段相互决定的问题。

**解决办法**：**拆表**；即把**仓库ID**和**管理员ID**单独放在一张表里面，**仓库ID、存储物品ID、数量**放在另外一张表里面。相互决定的两个字段单独放在一张表里面，**不与其他数据掺和在一起**。

### (3)第二范式和第三范式的区别

![image-20230513221430054](C:\Users\kxj\AppData\Roaming\Typora\typora-user-images\image-20230513221430054.png)